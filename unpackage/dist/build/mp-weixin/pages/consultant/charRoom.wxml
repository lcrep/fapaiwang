<view class="container"><view class="chatBox"><scroll-view class="scrollBox" style="height:100%;" scroll-top="{{scrollTop}}" scroll-y="true" scroll-into-view="{{viewId}}" data-event-opts="{{[['scrolltoupper',[['upper',['$event']]]],['scrolltolower',[['lower',['$event']]]],['scroll',[['scroll',['$event']]]]]}}" bindscrolltoupper="__e" bindscrolltolower="__e" bindscroll="__e"><view class="msgList"><block wx:if="{{loadStatus=='loading'}}"><view class="chattopLoadingBox"><image class="loadingIcon" src="../../static/images/loading.gif" mode></image></view></block><block wx:for="{{chatList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="message" id="{{'mid'+item.itemId}}"><view class="time"><text class="time-text">{{item.chatTime}}</text></view><view class="{{['main',item.style]}}"><view class="user"></view><block wx:if="{{item.style=='self'}}"><image class="avatar" src="{{myPic}}"></image></block><block wx:else><image class="avatar" src="{{chatUserPic}}"></image></block><view class="{{[(true)?'msg':'',(item.msgType==2||item.msgType==3)?'imgMsg':'']}}"><block wx:if="{{item.msgType==2||item.msgType==3}}"><view><block wx:if="{{item.msgType==2}}"><image style="width:250rpx;display:block;" src="{{item.chatMsg}}" mode="widthFix" data-url="{{item.chatMsg}}" data-event-opts="{{[['tap',[['previewImage',['$event']]]]]}}" bindtap="__e"></image></block><block wx:if="{{item.msgType==3}}"><view data-event-opts="{{[['tap',[['playVideo',['$0'],[[['chatList','',index,'chatMsg']]]]]]]}}" class="videoBox" bindtap="__e"><block wx:if="{{item.coverPath}}"><image class="videoCover" mode="widthFix" src="{{item.coverPath}}"></image></block><block wx:if="{{item.loading!=2&&item.loading!=3}}"><image class="videoPlayBtn" src="../../static/images/videoPlay.png" mode></image></block></view></block></view></block><block wx:else><block wx:if="{{item.msgType==1}}"><view><view class="template"><text class="msg-text" style="float:left;">{{item.chatMsg}}</text></view></view></block></block><block wx:if="{{(item.msgType==2||item.msgType==3)&&item.loading==1}}"><view class="loadingBox"><image class="loadingIcon" src="../../static/images/loading.gif" mode></image><text class="loadingText">上传中...</text></view></block><block wx:if="{{(item.msgType==2||item.msgType==3)&&item.loading==2}}"><view class="loadingBox loadingError"><uni-icons class="errorIcon" vue-id="{{'cc9670ec-1-'+index}}" type="info-filled" color="#f44a33" bind:__l="__l"></uni-icons><text class="loadingText">上传失败</text></view></block></view></view></view></block></view></scroll-view></view><view class="chatInput"><view class="inputTopBox"><input class="chatInputCon" type="text" placeholder="发送消息" placeholder-style="color:#B8B8B8;" data-event-opts="{{[['confirm',[['sendMsg',['$event']]]],['input',[['__set_model',['','chatText','$event',[]]]]]]}}" value="{{chatText}}" bindconfirm="__e" bindinput="__e"/><block wx:if="{{chatText.length>0}}"><view data-event-opts="{{[['tap',[['sendMsg',['$event']]]]]}}" class="sendMsg" bindtap="__e">发送</view></block></view><view class="inputBottomBox"><view class="mediaSel"><image class="mediaIcon" src="../../static/images/picSel.png" mode data-event-opts="{{[['tap',[['selMedia',['image',1]]]]]}}" bindtap="__e"></image></view><view class="mediaSel2"><image class="mediaIcon" src="../../static/images/vedioSel.png" mode data-event-opts="{{[['tap',[['selMedia',['video',1]]]]]}}" bindtap="__e"></image></view><view class="mediaSel"><image class="mediaIcon" src="../../static/images/cameraSel.png" mode data-event-opts="{{[['tap',[['selMedia',['image',2]]]]]}}" bindtap="__e"></image></view></view><uni-popup class="videoPop vue-ref" vue-id="cc9670ec-2" type="center" mask-click="{{true}}" data-ref="showVideo" bind:__l="__l" vue-slots="{{['default']}}"><view class="showVideoBox"><video class="video vue-ref" id="myVideo" src="{{videoSrc}}" controls data-ref="myVideo"></video><view data-event-opts="{{[['tap',[['cancel',['$event']]]]]}}" class="uni-image-close" bindtap="__e"><uni-icons vue-id="{{('cc9670ec-3')+','+('cc9670ec-2')}}" type="clear" color="#fff" size="30" bind:__l="__l"></uni-icons></view></view></uni-popup></view></view>
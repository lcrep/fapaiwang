{"version":3,"sources":["webpack:///D:/repositories/fapaiwang/main.js","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?8b80","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?7f8e","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?9c3c","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?2ba6","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?e8da","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?3041"],"names":["createPage","Page","socket","data","chatRel","myUserId","timer","timeout","myPic","chatUserId","chatUserPic","chatUserName","chatText","viewId","isOpened","scrollTop","pageNum","itemId","videoSrc","loadStatus","old","chatList","videoContext","onLoad","options","that","parseInt","openSocket","getHistory","onReady","uni","createVideoContext","setTimeout","goBottom","onShow","methods","param","startPage","$api","chatHistory","then","res","success","oppoUserId","datas","oppoUserHeadImg","userHeadImg","userNickName","oppoUserNickName","setNavigationBarTitle","title","result","rows","i","fromUserId","style","msgType","coverPath","chatMsg","$utils","common","ossVideoCoverSuffix","chatList1","finalList","concat","total","totalPageNum","Math","ceil","showToast","message","icon","heartCheckStart","setInterval","console","log","sendSocketMessage","fail","error","heartCheckReset","clearTimeout","id","socketUrl","connectSocket","url","complete","e","JSON","stringify","onSocketOpen","onSocketMessage","msg","obj","parse","undefined","listenMsg","onSocketClose","onSocketError","addData","chatContent","chatTime","sendTime","contentType","toUserId","push","selMedia","type","source","mediaType","sourceType","chooseImage","count","sizeType","size","tempFiles","uploadImg","chooseVideo","uploadVideo","fileRes","tempFilePaths","formatTime","Date","loading","theIndex","length","files","uploadFile","filesUpload","name","filePath","formData","statusCode","addImgChat","sendData","picUrl","tempFilePath","addVideoChat","playVideo","$nextTick","$refs","showVideo","open","requestFullScreen","play","cancel","close","pause","sendMsg","previewImage","event","target","dataset","urls","upper","lower","scroll","detail","goTop","getBoxheight","rects","height"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,wG;AACAA,UAAU,CAACC,iBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACa;;;AAGpE;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,WAAW,oPAEN;AACL,GAAG;AACH;AACA,WAAW,8LAEN;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnBA;AAAA;AAAA;AAAA;AAAqmB,CAAgB,knBAAG,EAAC,C;;;;;;;;;;;;mICAznB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,MAAJ,C;;AAEe;AACdC,MADc,kBACP;AACN,WAAO;AACNC,aAAO,EAAE,EADH;AAENC,cAAQ,EAAE,EAFJ;AAGNC,WAAK,EAAE,IAHD;AAINC,aAAO,EAAC,KAJF;AAKNC,WAAK,EAAE,EALD;AAMNC,gBAAU,EAAE,EANN;AAONC,iBAAW,EAAE,EAPP;AAQNC,kBAAY,EAAE,EARR;AASNC,cAAQ,EAAE,EATJ;AAUNC,YA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","file":"pages/consultant/charRoom.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/consultant/charRoom.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./charRoom.vue?vue&type=template&id=e4af879c&\"\nvar renderjs\nimport script from \"./charRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./charRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./charRoom.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"repositories/fapaiwang/pages/consultant/charRoom.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=template&id=e4af879c&\"","var components = {\n  \"uni-icons\": function() {\n    return import(\n      /* webpackChunkName: \"components/uni-icons/uni-icons\" */ \"@/components/uni-icons/uni-icons.vue\"\n    )\n  },\n  \"uni-popup\": function() {\n    return import(\n      /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nvar socket;\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tchatRel: '',\n\t\t\tmyUserId: \"\",\n\t\t\ttimer: null,\n\t\t\ttimeout:60000,\n\t\t\tmyPic: \"\",\n\t\t\tchatUserId: \"\",\n\t\t\tchatUserPic: \"\",\n\t\t\tchatUserName: \"\",\n\t\t\tchatText: \"\",\n\t\t\tviewId: \"\",\n\t\t\tisOpened: 0,\n\t\t\tscrollTop: 0,\n\t\t\tpageNum: 1,\n\t\t\titemId: 1,\n\t\t\tvideoSrc: \"\",\n\t\t\tloadStatus: 'more',\n\t\t\told: {\n\t\t\t\tscrollTop: 0\n\t\t\t},\n\t\t\tchatList: [],\n\t\t\tvideoContext: null\n\n\t\t}\n\t},\n\tonLoad(options) {\n\t\tconst that = this;\n\t\tlet myUserId = options.myUserId;\n\t\tlet chatUserId = options.chatUserId;\n\t\tthat.myUserId = myUserId;\n\t\tthat.chatUserId = chatUserId;\n\t\tthat.chatRel = parseInt(myUserId) > parseInt(chatUserId) ? (chatUserId + '_' + myUserId) : (myUserId + '_' +\n\t\t\tchatUserId);\n\t\tthat.openSocket(myUserId);\n\t\tthat.getHistory(1);\n\n\t},\n\tonReady() {\n\t\tthis.videoContext = uni.createVideoContext('myVideo')\n\t\tsetTimeout(() => {\n\t\t\tthis.goBottom();\n\t\t}, 100)\n\t},\n\tonShow() {\n\t\tif (this.isOpened == 0) {\n\t\t\tthis.openSocket(this.myUserId);\n\t\t}\n\t},\n\tmethods: {\n\t\tgetHistory(pageNum) {\n\t\t\tconst that = this;\n\t\t\tlet param = {\n\t\t\t\tchatRel: that.chatRel,\n\t\t\t\tstartPage: pageNum\n\t\t\t}\n\t\t\tthat.loadStatus = \"loading\";\n\t\t\tthat.$api.chatHistory(param).then(res => {\n\t\t\t\tif (res.success) {\n\t\t\t\t\tlet oppoUserId = res.datas.oppoUserId;\n\t\t\t\t\tif (oppoUserId == that.myUserId) {\n\t\t\t\t\t\tthat.myPic = res.datas.oppoUserHeadImg ? res.datas.oppoUserHeadImg :\n\t\t\t\t\t\t\t'../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserPic = res.datas.userHeadImg ? res.datas.userHeadImg : '../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserName = res.datas.userNickName;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthat.myPic = res.datas.userHeadImg ? res.datas.userHeadImg : '../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserPic = res.datas.oppoUserHeadImg ? res.datas.oppoUserHeadImg :\n\t\t\t\t\t\t\t'../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserName = res.datas.oppoUserNickName;\n\t\t\t\t\t}\n\t\t\t\t\tuni.setNavigationBarTitle({\n\t\t\t\t\t\ttitle: that.chatUserName\n\t\t\t\t\t});\n\t\t\t\t\tlet result = res.datas.rows;\n\t\t\t\t\tfor (var i in result) {\n\t\t\t\t\t\tif (result[i].fromUserId == that.myUserId) {\n\t\t\t\t\t\t\tresult[i].style = \"self\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[i].style = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (result[i].msgType == 3) {\n\t\t\t\t\t\t\tresult[i].coverPath = result[i].chatMsg + that.$utils.common.ossVideoCoverSuffix;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult[i].itemId = that.itemId;\n\t\t\t\t\t\tthat.itemId++;\n\t\t\t\t\t}\n\t\t\t\t\tlet chatList1 = that.chatList;\n\t\t\t\t\tlet finalList = result.concat(chatList1);\n\t\t\t\t\tthat.chatList = finalList;\n\t\t\t\t\tif (pageNum == 1) {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthat.goBottom();\n\t\t\t\t\t\t}, 300)\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthat.viewId = \"mid\" + (pageNum * 10);\n\t\t\t\t\t\t}, 100)\n\t\t\t\t\t}\n\t\t\t\t\tlet total = res.datas.total;\n\t\t\t\t\tlet totalPageNum = Math.ceil(total / 10);\n\t\t\t\t\tif (parseInt(totalPageNum) > parseInt(that.pageNum)) {\n\t\t\t\t\t\tthat.pageNum++;\n\t\t\t\t\t\tthat.loadStatus = \"more\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthat.loadStatus = \"noMore\";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.message,\n\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\theartCheckStart(){\n\t\t\tthis.timer = setInterval(() => {\n\t\t\t\tif (this.isOpened == 1) {\n\t\t\t\t\tconsole.log(\"连接状态，发送消息保持连接\");\n\t\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\t\tdata: \"ping\",\n\t\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail: (error) => {\n\t\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\t// 如果获取到消息，说明连接正常，重置心跳检测\n\t\t\t\t\tthis.heartCheckReset();\n\t\t\t\t\tthis.heartCheckStart();\n\t\t\t\t} else {\n\t\t\t\t      console.log(\"断开连接，尝试重连\");\n\t\t\t\t      this.openSocket(this.myUserId);\n\t\t\t\t  }\n\t\t\t}, this.timeout)\n\t\t},\n\t\theartCheckReset(){\n\t\t\t clearTimeout(this.timer);\n\t\t},\n\t\topenSocket(id) {\n\t\t\tconst that = this;\n\t\t\tvar socketUrl = \"wss://mobile.fpw365.cn/ws/imchannel/\" + id;\n\t\t\tuni.connectSocket({\n\t\t\t\turl: socketUrl,\n\t\t\t\tcomplete: (e) => {\n\t\t\t\t\tconsole.log(\"openSocket complete\" + JSON.stringify(e))\n\t\t\t\t},\n\t\t\t\tfail(error) {\n\t\t\t\t\tconsole.log(\"openSocket error\" +  JSON.stringify(error));\n\t\t\t\t}\n\t\t\t})\n\t\t\t//打开事件\n\t\t\tuni.onSocketOpen(function(res) {\n\t\t\t\tconsole.log('WebSocket 已打开');\n\t\t\t\tthat.isOpened = 1;\n\t\t\t\tthat.heartCheckReset();\n\t\t\t\tthat.heartCheckStart();\n\t\t\t});\n\t\t\t//获得消息事件\n\t\t\tuni.onSocketMessage(function(res) {\n\t\t\t\tconsole.log(msg.data);\n\t\t\t\tthat.heartCheckReset();\n\t\t\t\tthat.heartCheckStart();\n\t\t\t\t//发现消息进入    开始处理前端触发逻辑\n\t\t\t\tvar obj;\n\t\t\t\ttry {\n\t\t\t\t\tobj = JSON.parse(msg.data);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.log(e);\n\t\t\t\t}\n\t\t\t\tconsole.log(obj);\n\t\t\t\tif (obj != undefined) {\n\t\t\t\t\tif (obj.fromUserId && obj.fromUserId == -1) {\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthat.listenMsg(obj);\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t}\n\t\t\t});\n\t\t\t//关闭事件\n\t\t\tuni.onSocketClose(function(res) {\n\t\t\t\tconsole.log('WebSocket 已关闭！');\n\t\t\t\tthat.isOpened = 0;\n\t\t\t});\n\t\t\t//发生了错误事件\n\t\t\tuni.onSocketError(function(res) {\n\t\t\t\tconsole.log('WebSocket连接打开失败，请检查！');\n\t\t\t\tthat.isOpened = 0;\n\t\t\t});\n\t\t},\n\t\tlistenMsg(data) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: data.chatContent,\n\t\t\t\tchatTime: data.sendTime,\n\t\t\t\tfromUserId: data.fromUserId,\n\t\t\t\tmsgType: data.contentType,\n\t\t\t\ttoUserId: data.toUserId\n\t\t\t}\n\t\t\tif (data.contentType == 3) {\n\t\t\t\taddData.coverPath = data.chatContent + that.$utils.common.ossVideoCoverSuffix;\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t},\n\t\tselMedia(type, source) {\n\t\t\tconst that = this;\n\t\t\tvar mediaType;\n\n\t\t\tif (type == \"image\") {\n\t\t\t\tvar sourceType;\n\t\t\t\tif (source == 1) {\n\t\t\t\t\tsourceType = ['album'];\n\t\t\t\t} else {\n\t\t\t\t\tsourceType = ['camera'];\n\t\t\t\t}\n\t\t\t\tuni.chooseImage({\n\t\t\t\t\tcount: 1, //默认9\n\t\t\t\t\tsizeType: ['original'], //可以指定是原图还是压缩图，默认二者都有\n\t\t\t\t\tsourceType: sourceType, //从相册选择\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tlet size = res.tempFiles[0].size;\n\t\t\t\t\t\tif (size > 1024 * 1024 * 200) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"文件过大\",\n\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthat.uploadImg(res);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (type == \"video\") {\n\t\t\t\tuni.chooseVideo({\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tsourceType: ['camera', 'album'],\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\tif (res.size > 1024 * 1024 * 200) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"文件过大\",\n\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthat.uploadVideo(res);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t}\n\t\t},\n\t\tuploadImg(fileRes) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: fileRes.tempFilePaths[0],\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '2',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId,\n\t\t\t\tloading: 1\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t\tvar theIndex = (that.chatList.length - 1);\n\t\t\tlet files;\n\n\t\t\tfiles = fileRes.tempFilePaths[0];\n\n\n\n\n\t\t\tuni.uploadFile({\n\t\t\t\turl: that.$api.filesUpload, // 后端api接口\n\t\t\t\t//chooseImage函数调用后获取的本地文件路劲\n\t\t\t\tname: 'file', //后端通过'file'获取上传的文件对象\n\n\t\t\t\tfilePath: files,\n\n\n\n\n\t\t\t\tformData: {\n\t\t\t\t\t\"groupName\": \"chat\"\n\t\t\t\t},\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\tlet result = JSON.parse(res.data);\n\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\tthat.addImgChat(result.datas);\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"上传失败\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading = 2;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"上传失败\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\n\t\t},\n\t\taddImgChat(data) {\n\t\t\tconst that = this;\n\t\t\tconsole.log(data)\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket(that.myUserId);\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 2,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": data.picUrl\n\t\t\t}\n\t\t\tuni.sendSocketMessage({\n\t\t\t\tdata: JSON.stringify(sendData),\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t},\n\t\t\t});\n\n\t\t},\n\t\tuploadVideo(fileRes) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: fileRes.tempFilePath,\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '3',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId,\n\t\t\t\tloading: 1\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t\tvar theIndex = (that.chatList.length - 1);\n\t\t\tconsole.log(theIndex);\n\t\t\tlet files;\n\n\t\t\tfiles = fileRes.tempFilePath;\n\n\n\n\n\t\t\tuni.uploadFile({\n\t\t\t\turl: that.$api.filesUpload, // 后端api接口\n\t\t\t\t//chooseImage函数调用后获取的本地文件路劲\n\t\t\t\tname: 'file', //后端通过'file'获取上传的文件对象\n\n\t\t\t\tfilePath: files,\n\n\n\n\n\t\t\t\tformData: {\n\t\t\t\t\t\"groupName\": \"chat\"\n\t\t\t\t},\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\tlet result = JSON.parse(res.data);\n\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\tthat.addVideoChat(result.datas);\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading = 0;\n\t\t\t\t\t\t\tthat.chatList[theIndex].coverPath = result.datas.picUrl + that.$utils.common.ossVideoCoverSuffix;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"上传失败\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading = 2;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"上传失败\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\n\t\t},\n\t\tplayVideo(url) {\n\t\t\tconst that = this;\n\t\t\tthat.videoSrc = url;\n\t\t\tthat.videoContext = uni.createVideoContext('myVideo')\n\t\t\tthat.$nextTick(() => {\n\t\t\t\tthat.$refs.showVideo.open();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthat.videoContext.requestFullScreen();\n\t\t\t\t\tthat.videoContext.play();\n\t\t\t\t}, 300)\n\n\t\t\t})\n\n\n\n\t\t},\n\t\tcancel() {\n\t\t\tconst that = this;\n\t\t\tthat.$nextTick(() => {\n\t\t\t\tthat.$refs.showVideo.close()\n\t\t\t})\n\t\t\tthat.videoContext.pause();\n\t\t},\n\t\taddVideoChat(data) {\n\t\t\tconst that = this;\n\t\t\tconsole.log(data)\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket(that.myUserId);\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 3,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": data.picUrl\n\t\t\t}\n\t\t\tuni.sendSocketMessage({\n\t\t\t\tdata: JSON.stringify(sendData),\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tconsole.log(res);\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t},\n\t\t\t})\n\t\t},\n\t\tsendMsg() {\n\t\t\tconst that = this;\n\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket(that.myUserId);\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 1,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": that.chatText\n\t\t\t}\n\t\t\tuni.sendSocketMessage({\n\t\t\t\tdata: JSON.stringify(sendData)\n\t\t\t});\n\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: that.chatText,\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '1',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tthat.chatText = \"\";\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t},\n\t\tpreviewImage(event) {\n\t\t\tvar url = event.target.dataset.url;\n\t\t\tuni.previewImage({\n\t\t\t\turls: [url] // 需要预览的图片 http 链接列表\n\t\t\t});\n\t\t},\n\t\tupper: function(e) {\n\t\t\tconst that = this;\n\t\t\tif (that.loadStatus == \"noMore\") {\n\t\t\t\treturn;\n\t\t\t} else if (that.pageNum != 1) {\n\t\t\t\tthat.getHistory(that.pageNum);\n\t\t\t}\n\t\t},\n\t\tlower: function(e) {\n\t\t\tconsole.log(\"到底\")\n\t\t},\n\t\tscroll: function(e) {\n\t\t\tthis.old.scrollTop = e.detail.scrollTop\n\t\t},\n\t\tgoTop: function(e) {\n\t\t\tthis.scrollTop = this.old.scrollTop\n\t\t\tthis.$nextTick(function() {\n\t\t\t\tthis.scrollTop = 0\n\t\t\t});\n\t\t\tuni.showToast({\n\t\t\t\ticon: \"none\",\n\t\t\t\ttitle: \"纵向滚动 scrollTop 值已被修改为 0\"\n\t\t\t})\n\t\t},\n\t\tgoBottom: function() {\n\t\t\tconst that = this;\n\t\t\tthat.scrollTop = that.old.scrollTop\n\t\t\tthat.$utils.getBoxheight(`.msgList`, (rects) => {\n\t\t\t\tthat.$nextTick(function() {\n\t\t\t\t\tthat.scrollTop = rects[0].height\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1589383147292\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}
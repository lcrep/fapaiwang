{"version":3,"sources":["webpack:///D:/repositories/fapaiwang/main.js","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?8b80","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?7f8e","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?9c3c","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?2ba6","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?e8da","webpack:///D:/repositories/fapaiwang/pages/consultant/charRoom.vue?3041"],"names":["createPage","Page","socket","data","chatRel","myUserId","myPic","chatUserId","chatUserPic","chatUserName","chatText","viewId","isOpened","scrollTop","pageNum","itemId","videoSrc","loadStatus","old","chatList","videoContext","onLoad","options","that","parseInt","openSocket","getHistory","onReady","uni","createVideoContext","setTimeout","goBottom","methods","param","startPage","$api","chatHistory","then","res","success","oppoUserId","datas","oppoUserHeadImg","userHeadImg","userNickName","oppoUserNickName","result","rows","i","fromUserId","style","chatList1","finalList","concat","total","totalPageNum","Math","ceil","showToast","title","message","icon","id","WebSocket","console","log","socketUrl","close","onopen","onmessage","msg","obj","JSON","parse","e","undefined","listenMsg","onclose","onerror","addData","chatMsg","chatContent","chatTime","sendTime","msgType","contentType","toUserId","push","selMedia","type","source","mediaType","sourceType","chooseImage","count","sizeType","size","tempFiles","uploadImg","chooseVideo","uploadVideo","fileRes","tempFilePaths","$utils","formatTime","Date","loading","theIndex","length","files","uploadFile","url","filesUpload","name","filePath","formData","statusCode","addImgChat","fail","error","sendData","picUrl","send","stringify","tempFilePath","addVideoChat","playVideo","$nextTick","$refs","showVideo","open","play","cancel","pause","sendMsg","previewImage","event","target","dataset","urls","upper","lower","scroll","detail","goTop","getBoxheight","rects","height"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,wG;AACAA,UAAU,CAACC,iBAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqH;AACrH;AAC4D;AACL;AACa;;;AAGpE;AACmK;AACnK,gBAAgB,6KAAU;AAC1B,EAAE,8EAAM;AACR,EAAE,mFAAM;AACR,EAAE,4FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,uFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA,WAAW,sNAEN;AACL,GAAG;AACH;AACA,WAAW,oPAEN;AACL,GAAG;AACH;AACA,WAAW,8LAEN;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACxBA;AAAA;AAAA;AAAA;AAAqmB,CAAgB,knBAAG,EAAC,C;;;;;;;;;;;;mICAznB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAIC,MAAJ,C;AACe;AACdC,MADc,kBACP;AACN,WAAO;AACNC,aAAO,EAAE,EADH;AAENC,cAAQ,EAAE,EAFJ;AAGNC,WAAK,EAAE,EAHD;AAINC,gBAAU,EAAE,EAJN;AAKNC,iBAAW,EAAE,EALP;AAMNC,kBAAY,EAAE,EANR;AAONC,cAAQ,EAAE,EAPJ;AAQNC,YAAM,EAAE,EARF;AASNC,cAAQ,EAAE,CATJ;AAUNC,eA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","file":"pages/consultant/charRoom.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/consultant/charRoom.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./charRoom.vue?vue&type=template&id=e4af879c&\"\nvar renderjs\nimport script from \"./charRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./charRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./charRoom.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"repositories/fapaiwang/pages/consultant/charRoom.vue\"\nexport default component.exports","export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=template&id=e4af879c&\"","var components = {\n  \"uni-load-more\": function() {\n    return import(\n      /* webpackChunkName: \"components/uni-load-more/uni-load-more\" */ \"@/components/uni-load-more/uni-load-more.vue\"\n    )\n  },\n  \"uni-icons\": function() {\n    return import(\n      /* webpackChunkName: \"components/uni-icons/uni-icons\" */ \"@/components/uni-icons/uni-icons.vue\"\n    )\n  },\n  \"uni-popup\": function() {\n    return import(\n      /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n    )\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nvar socket;\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tchatRel: '',\n\t\t\tmyUserId: \"\",\n\t\t\tmyPic: \"\",\n\t\t\tchatUserId: \"\",\n\t\t\tchatUserPic: \"\",\n\t\t\tchatUserName: \"\",\n\t\t\tchatText: \"\",\n\t\t\tviewId: \"\",\n\t\t\tisOpened: 0,\n\t\t\tscrollTop: 0,\n\t\t\tpageNum: 1,\n\t\t\titemId: 1,\n\t\t\tvideoSrc:\"\",\n\t\t\tloadStatus: 'more',\n\t\t\told: {\n\t\t\t\tscrollTop: 0\n\t\t\t},\n\t\t\tchatList: [],\n\t\t\tvideoContext:null\n\n\t\t}\n\t},\n\tonLoad(options) {\n\t\tconst that = this;\n\t\tlet myUserId = options.myUserId;\n\t\tlet chatUserId = options.chatUserId;\n\t\tthat.myUserId = myUserId;\n\t\tthat.chatUserId = chatUserId;\n\t\tthat.chatRel = parseInt(myUserId) > parseInt(chatUserId) ? (chatUserId + '_' + myUserId) : (myUserId + '_' +\n\t\t\tchatUserId);\n\t\tthat.openSocket(myUserId);\n\t\tthat.getHistory(1);\n\t\t// uni.setNavigationBarTitle({\n\t\t// \ttitle: this.username.your\n\t\t// });\n\t},\n\tonReady(){\n\t\t this.videoContext = uni.createVideoContext('myVideo')\n\t\tsetTimeout(() => {\n\t\t\tthis.goBottom();\n\t\t}, 100)\n\t},\n\tmethods: {\n\t\tgetHistory(pageNum) {\n\t\t\tconst that = this;\n\t\t\tlet param = {\n\t\t\t\tchatRel: that.chatRel,\n\t\t\t\tstartPage: pageNum\n\t\t\t}\n\t\t\tthat.loadStatus = \"loading\";\n\t\t\tthat.$api.chatHistory(param).then(res => {\n\t\t\t\tif (res.success) {\n\t\t\t\t\tlet oppoUserId = res.datas.oppoUserId;\n\t\t\t\t\tif (oppoUserId == that.myUserId) {\n\t\t\t\t\t\tthat.myPic = res.datas.oppoUserHeadImg ? res.datas.oppoUserHeadImg : '../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserPic = res.datas.userHeadImg ? res.datas.userHeadImg : '../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserName = res.datas.userNickName;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthat.myPic = res.datas.userHeadImg ? res.datas.userHeadImg : '../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserPic = res.datas.oppoUserHeadImg ? res.datas.oppoUserHeadImg :\n\t\t\t\t\t\t\t'../../static/images/defaultUserPic.png';\n\t\t\t\t\t\tthat.chatUserName = res.datas.oppoUserNickName;\n\t\t\t\t\t}\n\t\t\t\t\tlet result = res.datas.rows;\n\t\t\t\t\tfor (var i in result) {\n\t\t\t\t\t\tif (result[i].fromUserId == that.myUserId) {\n\t\t\t\t\t\t\tresult[i].style = \"self\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult[i].style = \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult[i].itemId = that.itemId;\n\t\t\t\t\t\tthat.itemId++;\n\t\t\t\t\t}\n\t\t\t\t\tlet chatList1 = that.chatList;\n\t\t\t\t\tlet finalList = result.concat(chatList1);\n\t\t\t\t\tthat.chatList = finalList;\n\t\t\t\t\tif (pageNum == 1) {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthat.goBottom();\n\t\t\t\t\t\t}, 300)\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthat.viewId = \"mid\" + (pageNum * 10);\n\t\t\t\t\t\t}, 100)\n\t\t\t\t\t}\n\t\t\t\t\tlet total = res.datas.total;\n\t\t\t\t\tlet totalPageNum = Math.ceil(total / 10);\n\t\t\t\t\tif (parseInt(totalPageNum) > parseInt(that.pageNum)) {\n\t\t\t\t\t\tthat.pageNum++;\n\t\t\t\t\t\tthat.loadStatus = \"more\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthat.loadStatus = \"noMore\";\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: res.message,\n\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\topenSocket(id) {\n\t\t\tconst that = this;\n\t\t\tif (typeof(WebSocket) == \"undefined\") {\n\t\t\t\tconsole.log(\"不支持WebSocket\");\n\t\t\t} else {\n\t\t\t\tconsole.log(\"支持WebSocket\");\n\t\t\t\tvar socketUrl = \"wss://mobile.fpw365.cn/ws/imchannel/\" + id;\n\t\t\t\tif (socket != null) {\n\t\t\t\t\tsocket.close();\n\t\t\t\t\tsocket = null;\n\t\t\t\t}\n\t\t\t\tsocket = new WebSocket(socketUrl);\n\t\t\t\t//打开事件\n\t\t\t\tsocket.onopen = function() {\n\t\t\t\t\tthat.isOpened = 1;\n\t\t\t\t};\n\t\t\t\t//获得消息事件\n\t\t\t\tsocket.onmessage = function(msg) {\n\t\t\t\t\tconsole.log(msg.data);\n\t\t\t\t\t//发现消息进入    开始处理前端触发逻辑\n\t\t\t\t\tvar obj;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tobj = JSON.parse(msg.data);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(obj);\n\t\t\t\t\tif (obj != undefined) {\n\t\t\t\t\t\tif (obj.fromUserId && obj.fromUserId == -1) {\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthat.listenMsg(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\t\t\t\t//关闭事件\n\t\t\t\tsocket.onclose = function() {\n\t\t\t\t\tconsole.log(\"websocket已关闭\");\n\t\t\t\t};\n\t\t\t\t//发生了错误事件\n\t\t\t\tsocket.onerror = function() {\n\t\t\t\t\tconsole.log(\"websocket发生了错误\");\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tlistenMsg(data) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: data.chatContent,\n\t\t\t\tchatTime: data.sendTime,\n\t\t\t\tfromUserId: data.fromUserId,\n\t\t\t\tmsgType: data.contentType,\n\t\t\t\ttoUserId: data.toUserId\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t},\n\t\tselMedia(type, source) {\n\t\t\tconst that = this;\n\t\t\tvar mediaType;\n\n\t\t\tif (type == \"image\") {\n\t\t\t\tvar sourceType;\n\t\t\t\tif (source == 1) {\n\t\t\t\t\tsourceType = ['album'];\n\t\t\t\t} else {\n\t\t\t\t\tsourceType = ['camera'];\n\t\t\t\t}\n\t\t\t\tuni.chooseImage({\n\t\t\t\t\tcount: 1, //默认9\n\t\t\t\t\tsizeType: ['original'], //可以指定是原图还是压缩图，默认二者都有\n\t\t\t\t\tsourceType: sourceType, //从相册选择\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tlet size = res.tempFiles[0].size;\n\t\t\t\t\t\tif (size > 1024 * 1024 * 200) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"文件过大\",\n\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthat.uploadImg(res);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (type == \"video\") {\n\t\t\t\tuni.chooseVideo({\n\t\t\t\t\tcount: 1,\n\t\t\t\t\tsourceType: ['camera', 'album'],\n\t\t\t\t\tsuccess: function(res) {\n\t\t\t\t\t\tconsole.log(res);\n\t\t\t\t\t\tif(res.size>1024 * 1024 * 200){\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"文件过大\",\n\t\t\t\t\t\t\t\ticon: \"none\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tthat.uploadVideo(res);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t}\n\t\t},\n\t\tuploadImg(fileRes) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: fileRes.tempFilePaths[0],\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '2',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId,\n\t\t\t\tloading: 1\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t\tvar theIndex = (that.chatList.length-1);\n\t\t\t console.log(theIndex);\n\t\t\tlet files;\n\n\t\t\tfiles = fileRes.tempFilePaths[0];\n\n\n\n\n\t\t\tuni.uploadFile({\n\t\t\t\turl: that.$api.filesUpload, // 后端api接口\n\t\t\t\t//chooseImage函数调用后获取的本地文件路劲\n\t\t\t\tname: 'file', //后端通过'file'获取上传的文件对象\n\n\t\t\t\tfilePath: files,\n\n\n\n\n\t\t\t\tformData: {\n\t\t\t\t\t\"groupName\": \"chat\"\n\t\t\t\t},\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\tlet result = JSON.parse(res.data);\n\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\tthat.addImgChat(result.datas);\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading=0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"上传失败\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading=2;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"上传失败\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\n\t\t},\n\t\taddImgChat(data) {\n\t\t\tconst that = this;\n\t\t\tconsole.log(data)\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket();\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 2,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": data.picUrl\n\t\t\t}\n\t\t\tsocket.send(JSON.stringify(sendData));\n\t\t\t\n\t\t},\n\t\tuploadVideo(fileRes) {\n\t\t\tconst that = this;\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: fileRes.tempFilePath,\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '3',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId,\n\t\t\t\tloading: 1\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t\tvar theIndex = (that.chatList.length-1);\n\t\t\t console.log(theIndex);\n\t\t\tlet files;\n\n\t\t\tfiles = fileRes.tempFilePath;\n\n\n\n\n\t\t\tuni.uploadFile({\n\t\t\t\turl: that.$api.filesUpload, // 后端api接口\n\t\t\t\t//chooseImage函数调用后获取的本地文件路劲\n\t\t\t\tname: 'file', //后端通过'file'获取上传的文件对象\n\n\t\t\t\tfilePath: files,\n\n\n\n\n\t\t\t\tformData: {\n\t\t\t\t\t\"groupName\": \"chat\"\n\t\t\t\t},\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.statusCode == 200) {\n\t\t\t\t\t\tlet result = JSON.parse(res.data);\n\t\t\t\t\t\tconsole.log(result);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\tthat.addVideoChat(result.datas);\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading=0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: \"上传失败\"\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\tthat.chatList[theIndex].loading=2;\n\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfail: (error) => {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: \"上传失败\",\n\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t\n\t\t},\n\t\tplayVideo(url){\n\t\t\tconst that = this;\n\t\t\tthat.videoSrc=url;\n\t\t\tthat.$nextTick(() => {\n\t\t\t\tthat.$refs.showVideo.open()\n\t\t\t})\n\t\t\tthat.videoContext.play();\n\t\t},\n\t\tcancel() {\n\t\t\tconst that = this;\n\t\t\tthat.$nextTick(() => {\n\t\t\t\tthat.$refs.showVideo.close()\n\t\t\t})\n\t\t\tthat.videoContext.pause();\n\t\t},\n\t\taddVideoChat(data) {\n\t\t\tconst that = this;\n\t\t\tconsole.log(data)\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket();\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 3,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": data.picUrl\n\t\t\t}\n\t\t\tsocket.send(JSON.stringify(sendData));\n\t\t},\n\t\tsendMsg() {\n\t\t\tconst that = this;\n\n\t\t\tif (that.isOpened == 0) {\n\t\t\t\tconsole.log(\"open socket\");\n\t\t\t\tthat.openSocket();\n\t\t\t}\n\t\t\tlet sendData = {\n\t\t\t\t\"contentType\": 1,\n\t\t\t\t\"toUserId\": that.chatUserId,\n\t\t\t\t\"chatContent\": that.chatText\n\t\t\t}\n\t\t\tsocket.send(JSON.stringify(sendData));\n\n\t\t\tlet addData = {\n\t\t\t\tchatMsg: that.chatText,\n\t\t\t\tchatTime: that.$utils.formatTime(new Date()),\n\t\t\t\tfromUserId: that.myUserId,\n\t\t\t\tmsgType: '1',\n\t\t\t\tstyle: 'self',\n\t\t\t\ttoUserId: that.chatUserId\n\t\t\t}\n\t\t\tthat.chatList.push(addData);\n\t\t\tthat.chatText = \"\";\n\t\t\tsetTimeout(() => {\n\t\t\t\tthat.goBottom();\n\t\t\t}, 100)\n\t\t},\n\t\tpreviewImage(event) {\n\t\t\tvar url = event.target.dataset.url;\n\t\t\tuni.previewImage({\n\t\t\t\turls: [url] // 需要预览的图片 http 链接列表\n\t\t\t});\n\t\t},\n\t\tupper: function(e) {\n\t\t\tconst that = this;\n\t\t\tif (that.loadStatus == \"noMore\") {\n\t\t\t\treturn;\n\t\t\t} else if (that.pageNum != 1) {\n\t\t\t\tthat.getHistory(that.pageNum);\n\t\t\t}\n\t\t},\n\t\tlower: function(e) {\n\t\t\tconsole.log(\"到底\")\n\t\t},\n\t\tscroll: function(e) {\n\t\t\tthis.old.scrollTop = e.detail.scrollTop\n\t\t},\n\t\tgoTop: function(e) {\n\t\t\tthis.scrollTop = this.old.scrollTop\n\t\t\tthis.$nextTick(function() {\n\t\t\t\tthis.scrollTop = 0\n\t\t\t});\n\t\t\tuni.showToast({\n\t\t\t\ticon: \"none\",\n\t\t\t\ttitle: \"纵向滚动 scrollTop 值已被修改为 0\"\n\t\t\t})\n\t\t},\n\t\tgoBottom: function() {\n\t\t\tconst that = this;\n\t\t\tthat.scrollTop = that.old.scrollTop\n\t\t\tthat.$utils.getBoxheight(`.msgList`, (rects) => {\n\t\t\t\tthat.$nextTick(function() {\n\t\t\t\t\tthat.scrollTop = rects[0].height\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n","import mod from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./charRoom.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1588868708413\n      var cssReload = require(\"D:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}